<meta itemprop="name" content="{{ .Title }}">
<meta itemprop="description" content="{{ with .Description }}{{ . }}{{ else }}{{if .IsPage}}{{ .Summary }}{{ else }}{{ with .Site.Params.description }}{{ . }}{{ end }}{{ end }}{{ end }}">

{{- if .IsPage -}}
{{- $iso8601 := "2006-01-02T15:04:05-07:00" -}}
{{ with .PublishDate }}<meta itemprop="datePublished" {{ .Format $iso8601 | printf "content=%q" | safeHTMLAttr }} />{{ end}}
{{ with .Lastmod }}<meta itemprop="dateModified" {{ .Format $iso8601 | printf "content=%q" | safeHTMLAttr }} />{{ end}}
<meta itemprop="wordCount" content="{{ .WordCount }}">

{{- with $.Params.images -}}
{{- range first 6 . -}}<meta itemprop="image" content="{{ . | absURL }}">{{ end -}}
{{- else -}}
{{- $images := $.Resources.ByType "image" -}}
{{- $featured := $images.GetMatch "*feature*" -}}
{{- if not $featured }}{{ $featured = $images.GetMatch "{*cover*,*thumbnail*}" }}{{ end -}}
{{- with $featured -}}
<meta itemprop="image" content="{{ $featured.Permalink }}">
{{- else -}}
{{- with $.Site.Params.images -}}<meta itemprop="image" content="{{ index . 0 | absURL }}"/>{{ end -}}
{{- end -}}
{{- end -}}

<!-- Output all taxonomies as schema.org keywords -->
<meta itemprop="keywords" content="{{ if .IsPage}}{{ range $index, $tag := .Params.tags }}{{ $tag }},{{ end }}{{ else }}{{ range $plural, $terms := .Site.Taxonomies }}{{ range $term, $val := $terms }}{{ printf "%s," $term }}{{ end }}{{ end }}{{ end }}" />
{{- end -}}

{{- if .IsHome -}}
<script type="application/ld+json" nonce="yainz8od48">
  {
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "{{- site.Params.author -}}",
    "description": "{{- site.Params.description -}}",
    "url": "{{- site.BaseURL -}}",
    "thumbnailUrl": "{{- site.Params.thumbnailUrl | absURL |safeHTML -}}"
  }
</script>
{{- end -}}

{{- if .IsPage -}}
    <script type="application/ld+json" nonce="yainz8od48">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "articleSection" : "{{ .Section }}",
        "name" : "{{ .Title | safeJS }}",
        "headline" : "{{ .Title | safeJS }}",
        "description" : "{{ with .Description }}{{ . | safeJS }}{{ else }}{{ with .Summary }}{{ . }}{{ end }}{{ end }}",
        "inLanguage" : "en-US",
        "author" : "{{ site.Params.author }}",
        "creator" : "{{ site.Params.author }}",
        "accountablePerson" : "{{ site.Params.author }}",
        "copyrightHolder" : "{{ site.Params.author }}",
        "copyrightYear" : "{{ .Date.Format "2006" }}",
        "datePublished" : "{{ .Date.Format "2006" }}",
        "publisher": "{{ site.BaseURL }}",
        "logo": "{{ site.Params.favicon.default | absURL }}",
        "url" : "{{ .Permalink }}",
        "wordCount" : "{{ .WordCount }}",
        "image" : "{{ if .Params.cover }}{{- . | absURL -}}{{ else }}{{- site.Params.thumbnailUrl | absURL |safeHTML -}}{{- end -}}",
        "keywords" : [ "{{ if .IsPage}}{{ range $index, $tag := .Params.tags }}{{ $tag }},{{ end }}{{ else }}{{ range $plural, $terms := .Site.Taxonomies }}{{ range $term, $val := $terms }}{{ printf "%s," $term }}{{ end }}{{ end }}{{ end }}" ]
    }
    </script>
{{- end -}}