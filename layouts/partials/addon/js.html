{{- if site.Params.enablejs -}}

{{- $fingerprint := site.Params.fingerprint -}}
{{- $development := eq (hugo.Environment) "development" -}}
{{- $darkmode := site.Params.addon.darkmode -}}
{{- $clipboard := site.Params.addon.copybutton -}}

{{- $darkmodejs := resources.Get "js/darkmode.js" | js.Build "js/src/darkmode.js" | minify -}}
{{- $clipboardjs := resources.Get "js/clipboard.js" | js.Build "js/src/clipboard.js" | minify -}}

{{- if and $development $darkmode -}}
<script type="text/javascript" src="{{- $darkmodejs.RelPermalink -}}" defer></script>
{{- end -}}

{{- if and (eq .Kind "page") $development $clipboard -}}
<script type="text/javascript" src="{{- $clipboardjs.RelPermalink -}}" defer></script>
{{- end -}}

{{- if not $development -}}
{{- if and ($darkmode) (not $fingerprint) -}}
<script type="text/javascript" src="{{- $darkmodejs.RelPermalink -}}" defer></script>
{{- else -}}
{{- $darkmodefp := $darkmodejs | fingerprint "sha512" -}}
<script type="text/javascript" src="{{- $darkmodefp.RelPermalink -}}" defer integrity="{{- $darkmodefp.Data.Integrity -}}"></script>
{{- end -}}

{{- if and ($clipboard) (not $fingerprint) -}}
<script type="text/javascript" src="{{- $clipboardjs.RelPermalink -}}" defer></script>
{{- else -}}
{{- $clipboardfp := $clipboardjs | fingerprint "sha512" -}}
<script type="text/javascript" src="{{- $clipboardfp.RelPermalink -}}" defer integrity="{{- $clipboardfp.Data.Integrity -}}"></script>
{{- end -}}
{{- end -}}

{{- end -}}

