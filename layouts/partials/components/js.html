{{- if site.Params.js -}}
{{- $d := site.Params.js.darkmode -}}
{{- $c := site.Params.js.copybutton -}}
{{- $copy := findRE "<pre" .Content 1 -}}
{{- $darkmode := resources.Get "js/dark.js" -}}
{{- $clipboard := resources.Get "js/clipboard.js" -}}
{{- $all := slice $darkmode $clipboard | resources.Concat "js/bundle.js" -}}
{{- $h := hugo.IsProduction -}}
{{- if $h -}}
{{- $all := $all | minify | babel | fingerprint "sha384" -}}
{{- $darkmode := $darkmode | minify | babel | fingerprint "sha384" -}}
{{- end -}}
{{- if and $c $d $copy -}}
<script src="{{- $all.RelPermalink -}}" {{- if $h -}}integrity="{{- $all.Data.Integrity -}}" crossorigin="anonymous"{{- end -}} defer></script>
{{- else -}}{{- if and $d (not $copy) -}}
<script src="{{- $darkmode.RelPermalink -}}" {{- if $h -}}integrity="{{- $darkmode.Data.Integrity -}}" crossorigin="anonymous"{{- end -}} defer></script>
{{- end -}}
{{- end -}}
{{- end -}}
